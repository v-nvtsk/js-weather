!function(){"use strict";function t(t,e,i){const n=document.createElement(e);return i&&(n.id=i),t.append(n),n}const e="cities";var i={cities:[],init(){this.loadItems()},loadItems(){return this.cities=function(t){let e;try{e=JSON.parse(localStorage.getItem(t))}catch(t){e=null}return e}(e)||[],this.cities},saveItems(){!function(t,e){const i=JSON.stringify(e);localStorage.setItem(t,i)}(e,this.cities)},addCity(t){if(!t)return!1;const e=t.toUpperCase(),i=this.cities.indexOf(e);return-1!==i?this.cities=[e,...this.cities.slice(0,i),...this.cities.slice(i+1)]:this.cities.length>9?this.cities=[e,...this.cities.slice(0,9)]:this.cities=[e,...this.cities],this.saveItems(),this.listeners.forEach((t=>t(this.cities))),e},listeners:[],subscribe(t){this.listeners.push(t)}};let n,s,r,c,a,o,u;async function h(t){const e=await async function(t,e="ru"){const i=await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${t}&appid=ab4639f5754271e773ed6d3ffd73f327&units=metric&lang=${e}`),n=await i.json();let s,r,c;return 200!==n.cod?null:(s=n.name,r=n.main.temp,c=n.weather[0].icon,{city:s,temp:r,icon:c})}(t);e&&(function(t){t&&(s.innerHTML=`Current city: ${t.city}`,r.innerHTML=`Current temperature: ${t.temp}`,c.innerHTML=`<img src="https://openweathermap.org/img/wn/${t.icon}@2x.png">`)}(e),i.addCity(e.city))}document.addEventListener("DOMContentLoaded",(async()=>{!function(e){t(e,"h1","header").innerHTML="Weather forecast",n=t(e,"div","currentWeather"),s=t(n,"div","currentCity"),r=t(n,"div","currentTemp"),c=t(n,"div","currentIcon");const i=t(e,"form","inputGroup");a=t(i,"input","inputCity"),a.placeholder="Enter city",o=t(i,"button","submitBtn"),o.innerHTML="Get weather forecast",i.addEventListener("submit",(async t=>{t.preventDefault(),h(a.value),a.value=""})),u=t(i,"ul","savedCitiesList"),u.addEventListener("click",(t=>{"LI"===t.target.tagName&&h(t.target.innerHTML)}))}(document.querySelector("#app")),i.init(),i.subscribe((e=>{var i,n;n=e,(i=u).innerHTML="",n.forEach((e=>{t(i,"li").innerHTML=e}))})),h(await async function(){const t=await fetch("https://get.geojs.io/v1/ip/geo.json");return(await t.json()).city}())}))}();